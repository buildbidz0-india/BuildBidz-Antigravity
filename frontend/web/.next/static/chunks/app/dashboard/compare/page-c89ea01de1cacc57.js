(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{33766:function(e,t,a){Promise.resolve().then(a.bind(a,14728))},14728:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var r=a(57437),n=a(2265),i=a(60429),o=a(99397),s=a(51817),c=a(41169),l=a(92934),d=a(29116),u=a(69064);let p=[{id:"1",supplier_name:"",price:0,delivery_days:0,reputation_score:5},{id:"2",supplier_name:"",price:0,delivery_days:0,reputation_score:5}];function h(){var e,t,a,h,m,y;let[f,g]=(0,n.useState)("TMT Steel supply for Phase 1"),[x,j]=(0,n.useState)(p),[w,b]=(0,n.useState)(null),[v,N]=(0,n.useState)(!1),k=(e,t,a)=>{j(r=>r.map(r=>r.id===e?{...r,[t]:a}:r))},C=e=>{x.length<=2||(j(t=>t.filter(t=>t.id!==e)),b(null))},_=x.filter(e=>e.supplier_name.trim()&&e.price>0&&e.delivery_days>=0),S=async()=>{if(_.length<2){u.Am.error("Add at least 2 bids with supplier name and price.");return}N(!0),b(null);try{let e=await d.QU.compare(f,_);b(e),u.Am.success("Comparison complete.")}catch(e){u.Am.error(e instanceof Error?e.message:"Comparison failed.")}finally{N(!1)}};return(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Market Comparison"}),(0,r.jsx)("p",{className:"text-gray-500 mt-1",children:"Compare bids with AI-driven scoring and justification."})]}),(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requirement description"}),(0,r.jsx)("input",{type:"text",value:f,onChange:e=>g(e.target.value),className:"w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"e.g. TMT Steel supply for Phase 1"}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Bids"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{j(e=>[...e,{id:String(Date.now()),supplier_name:"",price:0,delivery_days:0,reputation_score:5}])},className:"flex items-center gap-2 text-orange-600 hover:text-orange-700 font-medium text-sm",children:[(0,r.jsx)(o.Z,{size:18})," Add bid"]})]}),(0,r.jsx)("div",{className:"mt-4 space-y-4",children:x.map(e=>(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 p-4 bg-gray-50 rounded-xl",children:[(0,r.jsx)("input",{placeholder:"Supplier name",value:e.supplier_name,onChange:t=>k(e.id,"supplier_name",t.target.value),className:"md:col-span-2 px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,r.jsx)("input",{type:"number",placeholder:"Price (₹)",value:e.price||"",onChange:t=>k(e.id,"price",Number(t.target.value)||0),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,r.jsx)("input",{type:"number",placeholder:"Delivery (days)",value:e.delivery_days||"",onChange:t=>k(e.id,"delivery_days",Number(t.target.value)||0),className:"px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"number",min:0,max:10,step:.1,placeholder:"Rep (0-10)",value:e.reputation_score||"",onChange:t=>k(e.id,"reputation_score",Number(t.target.value)||0),className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm"}),(0,r.jsx)("button",{type:"button",onClick:()=>C(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg text-sm",children:"Remove"})]})]},e.id))}),(0,r.jsxs)("button",{type:"button",onClick:S,disabled:v||_.length<2,className:"mt-6 flex items-center gap-2 bg-orange-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[v?(0,r.jsx)(s.Z,{size:20,className:"animate-spin"}):(0,r.jsx)(c.Z,{size:20}),"Compare with AI"]})]}),w&&(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100 bg-green-50 flex items-center gap-3",children:[(0,r.jsx)(l.Z,{className:"text-green-600",size:24}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold text-gray-900",children:["Recommended: ",String(null!==(m=null!==(h=null===(e=_.find(e=>e.id===w.recommended_bid_id))||void 0===e?void 0:e.supplier_name)&&void 0!==h?h:null===(a=w.rankings)||void 0===a?void 0:null===(t=a[0])||void 0===t?void 0:t.supplier)&&void 0!==m?m:w.recommended_bid_id)]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Score: ",w.score.toFixed(1)]})]})]}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Rankings"}),(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"text-left text-gray-500 border-b",children:[(0,r.jsx)("th",{className:"pb-2",children:"Rank"}),(0,r.jsx)("th",{className:"pb-2",children:"Supplier"}),(0,r.jsx)("th",{className:"pb-2",children:"Score"})]})}),(0,r.jsx)("tbody",{children:(null!==(y=w.rankings)&&void 0!==y?y:[]).map((e,t)=>{var a,n,i;return(0,r.jsxs)("tr",{className:"border-b border-gray-50",children:[(0,r.jsx)("td",{className:"py-2",children:null!==(a=e.rank)&&void 0!==a?a:t+1}),(0,r.jsx)("td",{className:"py-2",children:null!==(n=e.supplier)&&void 0!==n?n:"—"}),(0,r.jsx)("td",{className:"py-2",children:Number(null!==(i=e.total_score)&&void 0!==i?i:0).toFixed(1)})]},t)})})]}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-100 rounded-xl",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-orange-800 uppercase tracking-wider mb-2",children:"AI Justification"}),(0,r.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:w.justification})]})]})]})]})}},29116:function(e,t,a){"use strict";a.d(t,{Ai:function(){return l},QU:function(){return c},aH:function(){return p},jb:function(){return d},no:function(){return o},qx:function(){return s},s2:function(){return u}});let r=a(40257).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api/v1";async function n(){try{var e;let{auth:t}=await Promise.all([a.e(358),a.e(990),a.e(933),a.e(257)]).then(a.bind(a,54257));if(!t)return{};let r=await (null===(e=t.currentUser)||void 0===e?void 0:e.getIdToken());return r?{Authorization:"Bearer ".concat(r)}:{}}catch(e){return{}}}async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,n=null;for(let i=0;i<=a;i++)try{let n=await fetch(e,t);if((n.status>=500||429===n.status)&&i<a){let e=r*Math.pow(2,i);await new Promise(t=>setTimeout(t,e));continue}return n}catch(e){if(n=e instanceof Error?e:Error(String(e)),i<a){let e=r*Math.pow(2,i);await new Promise(t=>setTimeout(t,e))}}throw n||Error("Request failed after retries")}let o={chat:async(e,t,a)=>{let n=await i("".concat(r,"/ai/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,context:t,model:a})});if(!n.ok){var o;let e=await n.json().catch(()=>({}));throw Error((null===(o=e.detail)||void 0===o?void 0:o.message)||e.detail||"Failed to chat (".concat(n.status,")"))}return n.json()},ragChat:async(e,t,a)=>{let n=await i("".concat(r,"/ai/rag-chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,context:t,model:a})});if(!n.ok)throw Error((await n.json().catch(()=>({}))).detail||"Failed to chat with AI (".concat(n.status,")"));return n.json()},ingest:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",n=await fetch("".concat(r,"/ai/ingest"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,metadata:t,namespace:a})});if(!n.ok)throw Error((await n.json()).detail||"Failed to ingest document");return n.json()}},s={stats:async()=>{let e=await n(),t=await i("".concat(r,"/projects/stats"),{headers:{...e}});if(!t.ok)throw Error((await t.json().catch(()=>({}))).detail||"Failed to load stats (".concat(t.status,")"));return t.json()},list:async()=>{var e;let t=await n(),a=await i("".concat(r,"/projects"),{headers:{"Content-Type":"application/json",...t}});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to list projects (".concat(a.status,")"));return null!==(e=(await a.json()).projects)&&void 0!==e?e:[]},create:async e=>{let t=await n(),a=await fetch("".concat(r,"/projects"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to create project");return a.json()},getById:async e=>{let t=await n(),a=await fetch("".concat(r,"/projects/").concat(e),{headers:{...t}});if(404===a.status)return null;if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to load project");return a.json()},update:async(e,t)=>{let a=await n(),i=await fetch("".concat(r,"/projects/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",...a},body:JSON.stringify(t)});if(!i.ok)throw Error((await i.json().catch(()=>({}))).detail||"Failed to update project");return i.json()}},c={compare:async(e,t,a)=>{let o=await n(),s=await i("".concat(r,"/awards/compare"),{method:"POST",headers:{"Content-Type":"application/json",...o},body:JSON.stringify({requirement_description:e,bids:t,criteria:null!=a?a:{}})});if(!s.ok)throw Error((await s.json().catch(()=>({}))).detail||"Award comparison failed (".concat(s.status,")"));return s.json()},scoreOnly:async(e,t,a)=>{let i=await n(),o=await fetch("".concat(r,"/awards/score-only"),{method:"POST",headers:{"Content-Type":"application/json",...i},body:JSON.stringify({requirement_description:e,bids:t,criteria:null!=a?a:{}})});if(!o.ok)throw Error((await o.json().catch(()=>({}))).detail||"Scoring failed");return o.json()}},l={analyze:async e=>{let t=await n(),a=await i("".concat(r,"/forecast/analyze"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Forecast failed (".concat(a.status,")"));return a.json()}},d={send:async e=>{let t=await n(),a=await fetch("".concat(r,"/coordination/send"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Coordination failed");return a.json()}},u={extract:async e=>{let t=await n(),a=await fetch("".concat(r,"/extract/"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({ocr_text:e})});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Extraction failed");return a.json()}},p={transcribe:async e=>{let t=await n(),a=new FormData;a.append("file",e);let i=await fetch("".concat(r,"/transcribe/"),{method:"POST",headers:{...t},body:a});if(!i.ok)throw Error((await i.json().catch(()=>({}))).detail||"Transcription failed");return i.json()}}},79205:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var r=a(2265);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),o=e=>{let t=i(e);return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:p,...h}=e;return(0,r.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:a,strokeWidth:o?24*Number(i)/Number(n):i,className:s("lucide",d),...!u&&!c(h)&&{"aria-hidden":"true"},...h},[...p.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let a=(0,r.forwardRef)((a,i)=>{let{className:c,...l}=a;return(0,r.createElement)(d,{ref:i,iconNode:t,className:s("lucide-".concat(n(o(e))),"lucide-".concat(e),c),...l})});return a.displayName=o(e),a}},92934:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},41169:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("gavel",[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]])},51817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},99397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(79205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[429,659,971,117,744],function(){return e(e.s=33766)}),_N_E=e.O()}]);