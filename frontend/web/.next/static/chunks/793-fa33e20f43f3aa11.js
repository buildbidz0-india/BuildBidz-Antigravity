"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[793],{38793:function(e,t,a){a.d(t,{Z:function(){return x}});var r=a(57437),n=a(2265),o=a(5095),i=a(60429),s=a(82023),c=a(32489),l=a(82222),d=a(92369),u=a(51817),h=a(44743),p=a(29116),y=a(94508);let f=[{id:"c1",supplier_name:"L&T",price:148e4,delivery_days:21,reputation_score:9.2},{id:"c2",supplier_name:"Tata Projects",price:152e4,delivery_days:18,reputation_score:8.8},{id:"c3",supplier_name:"NCC",price:142e4,delivery_days:28,reputation_score:7.5}];function x(e){let{projectId:t,isOpen:a,onClose:x}=e,[m,g]=(0,n.useState)([]),[j,w]=(0,n.useState)(""),[b,v]=(0,n.useState)(!1),N=(0,n.useRef)(null);(0,n.useEffect)(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},[m,b]);let T=async()=>{if(!j.trim()||b)return;let e={role:"user",content:j};g(t=>[...t,e]),w(""),v(!0);try{let e=await p.no.ragChat(j),t={role:"assistant",content:e.content};g(e=>[...e,t])}catch(e){console.error("AI Chat error:",e),g(e=>[...e,{role:"assistant",content:"Sorry, I encountered an error. Please try again later."}])}finally{v(!1)}},C=async(e,t)=>{g(t=>[...t,{role:"user",content:e}]),v(!0);try{let e=await t();g(t=>[...t,{role:"assistant",content:e}])}catch(e){g(t=>[...t,{role:"assistant",content:"Error: ".concat(e instanceof Error?e.message:"Request failed",".")}])}finally{v(!1)}};return(0,r.jsx)(o.M,{children:a&&(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},className:"fixed bottom-6 right-6 w-[400px] h-[600px] bg-white rounded-3xl shadow-2xl border border-gray-100 flex flex-col z-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-100 bg-orange-600 text-white flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-2 bg-white/20 rounded-xl backdrop-blur-sm",children:(0,r.jsx)(s.Z,{size:20})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-lg leading-none",children:"Project Copilot"}),(0,r.jsx)("p",{className:"text-white/70 text-xs mt-1",children:"Experimental AI Assistant"})]})]}),(0,r.jsx)("button",{onClick:x,className:"p-2 hover:bg-white/10 rounded-xl transition-colors",children:(0,r.jsx)(c.Z,{size:20})})]}),(0,r.jsxs)("div",{ref:N,className:"flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth",children:[0===m.length&&(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 px-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-orange-50 rounded-2xl flex items-center justify-center text-orange-600",children:(0,r.jsx)(l.Z,{size:32})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-bold text-gray-900",children:"How can I help today?"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Ask me anything, or use a quick action below."})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,r.jsx)("button",{type:"button",onClick:()=>C("Compare sample bids",async()=>{var e,t;let a=await p.QU.compare("TMT Steel supply",f),r=null===(e=a.rankings)||void 0===e?void 0:e[0];return"**Bid comparison result**\n\nRecommended: **".concat(null!==(t=null==r?void 0:r.supplier)&&void 0!==t?t:a.recommended_bid_id,"** (score: ").concat(a.score.toFixed(1),")\n\n**AI Justification:**\n").concat(a.justification)}),disabled:b,className:"w-full py-2.5 px-4 bg-orange-50 hover:bg-orange-100 text-orange-700 rounded-xl text-sm font-medium border border-orange-100 disabled:opacity-50",children:"Compare sample bids"}),(0,r.jsx)("button",{type:"button",onClick:()=>C("Steel price forecast",async()=>{let e=await p.Ai.analyze({material:"steel",region:"delhi_ncr",quantity:10}),t=e.lock_rate_recommendation?"**LOCK** (recommended)":"**WAIT**";return"**Steel (TMT) forecast – Delhi NCR**\n\nTrend: ".concat(e.trend_direction,"\nCurrent: ₹").concat(e.current_price.toLocaleString(),"/Ton\n30-day forecast: ₹").concat(e.forecast_price_30d.toLocaleString(),"\n\nRecommendation: ").concat(t,"\n\n**AI Analysis:**\n").concat(e.ai_analysis)}),disabled:b,className:"w-full py-2.5 px-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-xl text-sm font-medium border border-gray-200 disabled:opacity-50",children:"Steel price forecast"})]})]}),m.map((e,t)=>(0,r.jsxs)(i.E.div,{initial:{opacity:0,x:"user"===e.role?10:-10},animate:{opacity:1,x:0},className:(0,y.cn)("flex items-start space-x-3","user"===e.role?"flex-row-reverse space-x-reverse":""),children:[(0,r.jsx)("div",{className:(0,y.cn)("flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center text-xs font-bold","user"===e.role?"bg-blue-100 text-blue-600":"bg-orange-100 text-orange-600"),children:"user"===e.role?(0,r.jsx)(d.Z,{size:16}):(0,r.jsx)(l.Z,{size:16})}),(0,r.jsx)("div",{className:(0,y.cn)("p-4 rounded-2xl text-sm leading-relaxed max-w-[80%]","user"===e.role?"bg-blue-600 text-white rounded-tr-none":"bg-gray-50 text-gray-800 rounded-tl-none border border-gray-100"),children:e.content})]},t)),b&&(0,r.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center text-orange-600",children:(0,r.jsx)(l.Z,{size:16})}),(0,r.jsx)("div",{className:"p-4 rounded-2xl bg-gray-50 text-gray-800 rounded-tl-none border border-gray-100",children:(0,r.jsx)(u.Z,{size:20,className:"animate-spin text-orange-600"})})]})]}),(0,r.jsx)("div",{className:"p-6 border-t border-gray-100",children:(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("input",{type:"text",value:j,onChange:e=>w(e.target.value),onKeyDown:e=>"Enter"===e.key&&T(),placeholder:"Ask your project assistant...",className:"w-full pl-5 pr-12 py-3.5 bg-gray-50 border border-gray-200 rounded-2xl focus:border-orange-600 focus:bg-white transition-all outline-none text-sm group-hover:border-gray-300"}),(0,r.jsx)("button",{onClick:T,disabled:b||!j.trim(),className:"absolute right-2 top-2 p-2 bg-orange-600 text-white rounded-xl hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(h.Z,{size:18})})]})})]})})}},29116:function(e,t,a){a.d(t,{Ai:function(){return c},QU:function(){return s},aH:function(){return u},jb:function(){return l},no:function(){return o},qx:function(){return i},s2:function(){return d}});let r=a(40257).env.NEXT_PUBLIC_API_URL||"http://localhost:8000/api/v1";async function n(){try{var e;let{auth:t}=await Promise.all([a.e(358),a.e(990),a.e(933),a.e(257)]).then(a.bind(a,54257));if(!t)return{};let r=await (null===(e=t.currentUser)||void 0===e?void 0:e.getIdToken());return r?{Authorization:"Bearer ".concat(r)}:{}}catch(e){return{}}}let o={chat:async(e,t,a)=>{let n=await fetch("".concat(r,"/ai/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e,context:t,model:a})});if(!n.ok){var o;let e=await n.json();throw Error((null===(o=e.detail)||void 0===o?void 0:o.message)||e.detail||"Failed to chat")}return n.json()},ragChat:async(e,t,a)=>{let n=await fetch("".concat(r,"/ai/rag-chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e,context:t,model:a})});if(!n.ok)throw Error((await n.json()).detail||"Failed to chat with AI");return n.json()},ingest:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",n=await fetch("".concat(r,"/ai/ingest"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,metadata:t,namespace:a})});if(!n.ok)throw Error((await n.json()).detail||"Failed to ingest document");return n.json()}},i={stats:async()=>{let e=await n(),t=await fetch("".concat(r,"/projects/stats"),{headers:{...e}});if(!t.ok)throw Error((await t.json().catch(()=>({}))).detail||"Failed to load stats");return t.json()},list:async()=>{var e;let t=await n(),a=await fetch("".concat(r,"/projects"),{headers:{"Content-Type":"application/json",...t}});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to list projects");return null!==(e=(await a.json()).projects)&&void 0!==e?e:[]},create:async e=>{let t=await n(),a=await fetch("".concat(r,"/projects"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to create project");return a.json()},getById:async e=>{let t=await n(),a=await fetch("".concat(r,"/projects/").concat(e),{headers:{...t}});if(404===a.status)return null;if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Failed to load project");return a.json()},update:async(e,t)=>{let a=await n(),o=await fetch("".concat(r,"/projects/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",...a},body:JSON.stringify(t)});if(!o.ok)throw Error((await o.json().catch(()=>({}))).detail||"Failed to update project");return o.json()}},s={compare:async(e,t,a)=>{let o=await n(),i=await fetch("".concat(r,"/awards/compare"),{method:"POST",headers:{"Content-Type":"application/json",...o},body:JSON.stringify({requirement_description:e,bids:t,criteria:null!=a?a:{}})});if(!i.ok)throw Error((await i.json().catch(()=>({}))).detail||"Award comparison failed");return i.json()},scoreOnly:async(e,t,a)=>{let o=await n(),i=await fetch("".concat(r,"/awards/score-only"),{method:"POST",headers:{"Content-Type":"application/json",...o},body:JSON.stringify({requirement_description:e,bids:t,criteria:null!=a?a:{}})});if(!i.ok)throw Error((await i.json().catch(()=>({}))).detail||"Scoring failed");return i.json()}},c={analyze:async e=>{let t=await n(),a=await fetch("".concat(r,"/forecast/analyze"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Forecast failed");return a.json()}},l={send:async e=>{let t=await n(),a=await fetch("".concat(r,"/coordination/send"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify(e)});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Coordination failed");return a.json()}},d={extract:async e=>{let t=await n(),a=await fetch("".concat(r,"/extract/"),{method:"POST",headers:{"Content-Type":"application/json",...t},body:JSON.stringify({ocr_text:e})});if(!a.ok)throw Error((await a.json().catch(()=>({}))).detail||"Extraction failed");return a.json()}},u={transcribe:async e=>{let t=await n(),a=new FormData;a.append("file",e);let o=await fetch("".concat(r,"/transcribe/"),{method:"POST",headers:{...t},body:a});if(!o.ok)throw Error((await o.json().catch(()=>({}))).detail||"Transcription failed");return o.json()}}},94508:function(e,t,a){a.d(t,{cn:function(){return o}});var r=a(61994),n=a(53335);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}}}]);